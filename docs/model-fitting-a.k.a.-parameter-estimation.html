<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Model Fitting (A.K.A. parameter estimation) | BIOL120 Excercise Guidebook</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Model Fitting (A.K.A. parameter estimation) | BIOL120 Excercise Guidebook" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Model Fitting (A.K.A. parameter estimation) | BIOL120 Excercise Guidebook" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Professors Jackie Dresch and Javier F. Tabima Restrepo" />


<meta name="date" content="2022-11-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="m-files-functions-and-simple-plotting-tools.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Biology (BIOL120)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Quantitative Biology (BIOL120) Excercise Guidebook</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#additional-information-about-the-professor"><i class="fa fa-check"></i>Additional information about the professor</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="structure-of-the-guidebook-and-faqs.html"><a href="structure-of-the-guidebook-and-faqs.html"><i class="fa fa-check"></i><b>2</b> Structure of the Guidebook and FAQs</a>
<ul>
<li class="chapter" data-level="2.1" data-path="structure-of-the-guidebook-and-faqs.html"><a href="structure-of-the-guidebook-and-faqs.html#what-do-we-need-for-lab-sessions"><i class="fa fa-check"></i><b>2.1</b> What do we need for lab sessions?</a></li>
<li class="chapter" data-level="2.2" data-path="structure-of-the-guidebook-and-faqs.html"><a href="structure-of-the-guidebook-and-faqs.html#why-are-we-using-these-programs"><i class="fa fa-check"></i><b>2.2</b> Why are we using these programs?</a></li>
<li class="chapter" data-level="2.3" data-path="structure-of-the-guidebook-and-faqs.html"><a href="structure-of-the-guidebook-and-faqs.html#do-we-need-to-know-how-to-program"><i class="fa fa-check"></i><b>2.3</b> Do we need to know how to program?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>3</b> Software for class</a>
<ul>
<li class="chapter" data-level="3.1" data-path="software.html"><a href="software.html#how-to-install-r"><i class="fa fa-check"></i><b>3.1</b> How to install R?</a></li>
<li class="chapter" data-level="3.2" data-path="software.html"><a href="software.html#how-to-install-rstudio"><i class="fa fa-check"></i><b>3.2</b> How to install RStudio?</a></li>
<li class="chapter" data-level="3.3" data-path="software.html"><a href="software.html#how-to-install-atom"><i class="fa fa-check"></i><b>3.3</b> How to install Atom?</a></li>
<li class="chapter" data-level="3.4" data-path="software.html"><a href="software.html#how-to-install-matlab"><i class="fa fa-check"></i><b>3.4</b> How to install MATLAB?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="testing-the-software.html"><a href="testing-the-software.html"><i class="fa fa-check"></i><b>4</b> Testing the software</a>
<ul>
<li class="chapter" data-level="4.1" data-path="testing-the-software.html"><a href="testing-the-software.html#testing-r-and-rstudio"><i class="fa fa-check"></i><b>4.1</b> Testing R and RStudio</a></li>
<li class="chapter" data-level="4.2" data-path="testing-the-software.html"><a href="testing-the-software.html#testing-atom"><i class="fa fa-check"></i><b>4.2</b> Testing Atom</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rmark.html"><a href="rmark.html"><i class="fa fa-check"></i><b>5</b> Introduction to electronic notebooks in R Markdown</a>
<ul>
<li class="chapter" data-level="5.1" data-path="rmark.html"><a href="rmark.html#markdown-formats"><i class="fa fa-check"></i><b>5.1</b> Markdown formats</a></li>
<li class="chapter" data-level="5.2" data-path="rmark.html"><a href="rmark.html#basics-of-markdown"><i class="fa fa-check"></i><b>5.2</b> Basics of Markdown</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="rmark.html"><a href="rmark.html#basic-syntax"><i class="fa fa-check"></i><b>5.2.1</b> Basic syntax</a></li>
<li class="chapter" data-level="5.2.2" data-path="rmark.html"><a href="rmark.html#lines-of-code"><i class="fa fa-check"></i><b>5.2.2</b> Lines of code</a></li>
<li class="chapter" data-level="5.2.3" data-path="rmark.html"><a href="rmark.html#lists"><i class="fa fa-check"></i><b>5.2.3</b> Lists</a></li>
<li class="chapter" data-level="5.2.4" data-path="rmark.html"><a href="rmark.html#horizontal-rules"><i class="fa fa-check"></i><b>5.2.4</b> Horizontal rules</a></li>
<li class="chapter" data-level="5.2.5" data-path="rmark.html"><a href="rmark.html#links-figures-and-tables"><i class="fa fa-check"></i><b>5.2.5</b> Links, figures and tables</a></li>
<li class="chapter" data-level="5.2.6" data-path="rmark.html"><a href="rmark.html#tables"><i class="fa fa-check"></i><b>5.2.6</b> Tables</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="rmark.html"><a href="rmark.html#r-markdown-excerise"><i class="fa fa-check"></i><b>5.3</b> R Markdown Excerise:</a></li>
<li class="chapter" data-level="5.4" data-path="rmark.html"><a href="rmark.html#additional-information-on-markdown"><i class="fa fa-check"></i><b>5.4</b> Additional information on Markdown</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>6</b> Creating datasets and replicability</a>
<ul>
<li class="chapter" data-level="6.1" data-path="datasets.html"><a href="datasets.html#creating-basic-datasets"><i class="fa fa-check"></i><b>6.1</b> Creating basic datasets</a></li>
<li class="chapter" data-level="6.2" data-path="datasets.html"><a href="datasets.html#asking-biological-questions-and-identifying-measurable-outcomes"><i class="fa fa-check"></i><b>6.2</b> Asking biological questions and identifying measurable outcomes</a></li>
<li class="chapter" data-level="6.3" data-path="datasets.html"><a href="datasets.html#creating-a-clean-raw-dataset"><i class="fa fa-check"></i><b>6.3</b> Creating a clean raw dataset</a></li>
<li class="chapter" data-level="6.4" data-path="datasets.html"><a href="datasets.html#creating-basic-basic-plots-in-r"><i class="fa fa-check"></i><b>6.4</b> Creating basic (basic) plots in R</a></li>
<li class="chapter" data-level="6.5" data-path="datasets.html"><a href="datasets.html#comparisons-between-groups."><i class="fa fa-check"></i><b>6.5</b> Comparisons between groups.</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>7</b> Basic R (1): Vectors</a>
<ul>
<li class="chapter" data-level="7.1" data-path="vectors.html"><a href="vectors.html#basic-data-structures-in-r"><i class="fa fa-check"></i><b>7.1</b> Basic data structures in R</a></li>
<li class="chapter" data-level="7.2" data-path="vectors.html"><a href="vectors.html#unidimensional-objects-vectors"><i class="fa fa-check"></i><b>7.2</b> Unidimensional objects: Vectors</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="vectors.html"><a href="vectors.html#classes-of-vectors"><i class="fa fa-check"></i><b>7.2.1</b> Classes of vectors</a></li>
<li class="chapter" data-level="7.2.2" data-path="vectors.html"><a href="vectors.html#expanding-vectors"><i class="fa fa-check"></i><b>7.2.2</b> Expanding vectors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="basic-r-2-data-frames.html"><a href="basic-r-2-data-frames.html"><i class="fa fa-check"></i><b>8</b> Basic R (2) : Data frames</a>
<ul>
<li class="chapter" data-level="8.1" data-path="basic-r-2-data-frames.html"><a href="basic-r-2-data-frames.html#creating-tables-using-vectors"><i class="fa fa-check"></i><b>8.1</b> Creating tables using vectors</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="basic-r-2-data-frames.html"><a href="basic-r-2-data-frames.html#accessing-specific-rows-and-columns"><i class="fa fa-check"></i><b>8.1.1</b> Accessing specific rows and columns</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="basic-r-2-data-frames.html"><a href="basic-r-2-data-frames.html#data-frames-versus-matrices"><i class="fa fa-check"></i><b>8.2</b> Data frames versus matrices</a></li>
<li class="chapter" data-level="8.3" data-path="basic-r-2-data-frames.html"><a href="basic-r-2-data-frames.html#combining-different-two-dimensional-data-structures"><i class="fa fa-check"></i><b>8.3</b> Combining different two-dimensional data structures</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="basic-r-2-data-frames.html"><a href="basic-r-2-data-frames.html#combining-by-rows"><i class="fa fa-check"></i><b>8.3.1</b> Combining by rows</a></li>
<li class="chapter" data-level="8.3.2" data-path="basic-r-2-data-frames.html"><a href="basic-r-2-data-frames.html#combining-by-columns"><i class="fa fa-check"></i><b>8.3.2</b> Combining by columns</a></li>
<li class="chapter" data-level="8.3.3" data-path="basic-r-2-data-frames.html"><a href="basic-r-2-data-frames.html#reading-in-data-tables"><i class="fa fa-check"></i><b>8.3.3</b> Reading in data tables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sumarizing-and-subsetting-data-frames.html"><a href="sumarizing-and-subsetting-data-frames.html"><i class="fa fa-check"></i><b>9</b> Sumarizing and subsetting data frames</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sumarizing-and-subsetting-data-frames.html"><a href="sumarizing-and-subsetting-data-frames.html#reading-in-the-dataframe"><i class="fa fa-check"></i><b>9.1</b> Reading in the dataframe</a></li>
<li class="chapter" data-level="9.2" data-path="sumarizing-and-subsetting-data-frames.html"><a href="sumarizing-and-subsetting-data-frames.html#summarizing-and-subsetting-data"><i class="fa fa-check"></i><b>9.2</b> Summarizing and subsetting data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sumarizing-and-subsetting-data-frames.html"><a href="sumarizing-and-subsetting-data-frames.html#summarizing-data"><i class="fa fa-check"></i><b>9.2.1</b> Summarizing data</a></li>
<li class="chapter" data-level="9.2.2" data-path="sumarizing-and-subsetting-data-frames.html"><a href="sumarizing-and-subsetting-data-frames.html#summarizing-data-1"><i class="fa fa-check"></i><b>9.2.2</b> Summarizing data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plots.html"><a href="plots.html"><i class="fa fa-check"></i><b>10</b> Plotting data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="plots.html"><a href="plots.html#using-ggplot2-to-plot-in-r"><i class="fa fa-check"></i><b>10.1</b> Using <code>ggplot2</code> to plot in <code>R</code></a></li>
<li class="chapter" data-level="10.2" data-path="plots.html"><a href="plots.html#different-types-of-plots"><i class="fa fa-check"></i><b>10.2</b> Different types of plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="plots.html"><a href="plots.html#histogram"><i class="fa fa-check"></i><b>10.2.1</b> Histogram</a></li>
<li class="chapter" data-level="10.2.2" data-path="plots.html"><a href="plots.html#barplots"><i class="fa fa-check"></i><b>10.2.2</b> Barplots</a></li>
<li class="chapter" data-level="10.2.3" data-path="plots.html"><a href="plots.html#scatterplots"><i class="fa fa-check"></i><b>10.2.3</b> Scatterplots</a></li>
<li class="chapter" data-level="10.2.4" data-path="plots.html"><a href="plots.html#boxplots-violin-plots-and-distributions"><i class="fa fa-check"></i><b>10.2.4</b> Boxplots, violin plots and distributions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="plots.html"><a href="plots.html#more-resources-on-ggplot2"><i class="fa fa-check"></i><b>10.3</b> More resources on <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="using-matlab-as-a-powerful-calculator.html"><a href="using-matlab-as-a-powerful-calculator.html"><i class="fa fa-check"></i><b>11</b> Using MATLAB as a Powerful Calculator</a>
<ul>
<li class="chapter" data-level="11.1" data-path="using-matlab-as-a-powerful-calculator.html"><a href="using-matlab-as-a-powerful-calculator.html#matlab-basics-for-calculation"><i class="fa fa-check"></i><b>11.1</b> MATLAB Basics for calculation:</a></li>
<li class="chapter" data-level="11.2" data-path="using-matlab-as-a-powerful-calculator.html"><a href="using-matlab-as-a-powerful-calculator.html#early-words-of-caution"><i class="fa fa-check"></i><b>11.2</b> Early words of caution:</a></li>
<li class="chapter" data-level="11.3" data-path="using-matlab-as-a-powerful-calculator.html"><a href="using-matlab-as-a-powerful-calculator.html#dealing-with-vectorsmatrices"><i class="fa fa-check"></i><b>11.3</b> Dealing with vectors/matrices:</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="using-matlab-as-a-powerful-calculator.html"><a href="using-matlab-as-a-powerful-calculator.html#defining-a-vectormatrix"><i class="fa fa-check"></i><b>11.3.1</b> Defining a vector/matrix:</a></li>
<li class="chapter" data-level="11.3.2" data-path="using-matlab-as-a-powerful-calculator.html"><a href="using-matlab-as-a-powerful-calculator.html#accessing-elements-adding-and-subtracting"><i class="fa fa-check"></i><b>11.3.2</b> Accessing Elements, Adding, and Subtracting</a></li>
<li class="chapter" data-level="11.3.3" data-path="using-matlab-as-a-powerful-calculator.html"><a href="using-matlab-as-a-powerful-calculator.html#multiplying-two-vectorsmatrices"><i class="fa fa-check"></i><b>11.3.3</b> Multiplying two vectors/matrices:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="m-files-functions-and-simple-plotting-tools.html"><a href="m-files-functions-and-simple-plotting-tools.html"><i class="fa fa-check"></i><b>12</b> m files, functions, and Simple Plotting Tools</a>
<ul>
<li class="chapter" data-level="12.1" data-path="m-files-functions-and-simple-plotting-tools.html"><a href="m-files-functions-and-simple-plotting-tools.html#m-files"><i class="fa fa-check"></i><b>12.1</b> m files</a></li>
<li class="chapter" data-level="12.2" data-path="m-files-functions-and-simple-plotting-tools.html"><a href="m-files-functions-and-simple-plotting-tools.html#functions"><i class="fa fa-check"></i><b>12.2</b> functions</a></li>
<li class="chapter" data-level="12.3" data-path="m-files-functions-and-simple-plotting-tools.html"><a href="m-files-functions-and-simple-plotting-tools.html#plotting-function-output-model-predictions"><i class="fa fa-check"></i><b>12.3</b> Plotting function output / model predictions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="model-fitting-a.k.a.-parameter-estimation.html"><a href="model-fitting-a.k.a.-parameter-estimation.html"><i class="fa fa-check"></i><b>13</b> Model Fitting (A.K.A. parameter estimation)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="model-fitting-a.k.a.-parameter-estimation.html"><a href="model-fitting-a.k.a.-parameter-estimation.html#importing-numerical-data"><i class="fa fa-check"></i><b>13.1</b> Importing Numerical Data</a></li>
<li class="chapter" data-level="13.2" data-path="model-fitting-a.k.a.-parameter-estimation.html"><a href="model-fitting-a.k.a.-parameter-estimation.html#creating-a-model-function"><i class="fa fa-check"></i><b>13.2</b> Creating a Model Function</a></li>
<li class="chapter" data-level="13.3" data-path="model-fitting-a.k.a.-parameter-estimation.html"><a href="model-fitting-a.k.a.-parameter-estimation.html#creating-an-objective-error-function"><i class="fa fa-check"></i><b>13.3</b> Creating an Objective / Error Function</a></li>
<li class="chapter" data-level="13.4" data-path="model-fitting-a.k.a.-parameter-estimation.html"><a href="model-fitting-a.k.a.-parameter-estimation.html#fitting-your-model-to-your-data"><i class="fa fa-check"></i><b>13.4</b> Fitting your Model to your Data</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="model-fitting-a.k.a.-parameter-estimation.html"><a href="model-fitting-a.k.a.-parameter-estimation.html#running-fminsearch"><i class="fa fa-check"></i><b>13.4.1</b> Running fminsearch()</a></li>
<li class="chapter" data-level="13.4.2" data-path="model-fitting-a.k.a.-parameter-estimation.html"><a href="model-fitting-a.k.a.-parameter-estimation.html#visualizing-the-best-fit"><i class="fa fa-check"></i><b>13.4.2</b> Visualizing the Best Fit</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIOL120 Excercise Guidebook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-fitting-a.k.a.-parameter-estimation" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Model Fitting (A.K.A. parameter estimation)<a href="model-fitting-a.k.a.-parameter-estimation.html#model-fitting-a.k.a.-parameter-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="importing-numerical-data" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Importing Numerical Data<a href="model-fitting-a.k.a.-parameter-estimation.html#importing-numerical-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Using dlmread</p>
<ul>
<li><p>The data must be in a delimited format (i.e. a matrix of values, with entries separated by spaces, tabs, or commas).</p></li>
<li><p>The data file must be in your <code>Current Folder</code>.</p></li>
<li><p>When using <code>dlmread()</code>, the filename needs to be in single quotation marks.</p></li>
<li><p>Save your data to a new variable when you read it into MATLAB (i.e. <code>D = dlmread('mydata.txt')</code>).</p>
<p>Example:</p>
<p>First we make sure the data file is in our <code>Current Folder</code>, use <code>dlmread()</code> to read it and save it to a new variable, D.<br />
Note: We can then check that our data is indeed contained in the matrix D.</p>
<p><img src="import_GT.png" /></p>
<p>If we want to visualize our dataset before moving on to model fitting, we can use the <code>plot()</code> command.</p>
<p>Note: In this example, the first column of data contains the independent variable (% AP) and the second column of data contains the dependent variable (normalized GT mRNA concentration).
<img src="GT_figure.png" /></p></li>
</ul>
<div class="rmdquestion">
<h4 id="question-1">
<p>Question 1</p>
</h4>
<p>
<p>Download the <em>dicty</em> average growth data generated in the Larochelle Lab from the course moodle.</p>
</p>
<p>
<p>Save this file in your <code>Current Folder</code>.</p>
</p>
<p>
<p>Use the <code>dlmread()</code> command to read in the data and save it as a matrix (you can call this matrix whatever you want - i.e. I used D in the example above).</p>
</p>
<p>
<p>Use a scatter plot to visualize the data.<br /></p>
<ul>
<li>The first column is time (in hours), the second column is the corresponding population of AX4 cells (in thous. cells / mL), and the third column is the corresponding population of DnmA Knock Out cells (in thous. cells / mL).<br />
Hint: To visualize both populations on the same figure, scatter one, then<br />
<code>hold on</code> and scatter the other.<br /></li>
<li>Include a title and don’t forget to label your axes.<br /></li>
<li>You can also add a legend using the drop down menu: <code>Insert -&gt; Legend</code>.
</p>
</div></li>
</ul></li>
</ul>
</div>
<div id="creating-a-model-function" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Creating a Model Function<a href="model-fitting-a.k.a.-parameter-estimation.html#creating-a-model-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Looking at your data, you now want to create a mathematical model to fit to your data. We have seen two different models for population growth in class. You may choose to fit one of these functions to the <em>dicty</em> average growth data or you may choose to create a new function based on something you have learned in another class or textbook. Whatever model you choose, it will be important that you answer each of the following:</p>
<ol style="list-style-type: decimal">
<li><p>Do you have a good reason for choosing your model? It could be as simple as “my data seems to follow the shape of the curve generated by this model”.</p></li>
<li><p>What are the underlying model assumptions? i.e. The population has the ability to grow without bound.</p></li>
<li><p>What are the independent variable(s), parameter(s), and dependent variable(s)? This is where it is important to think about both the model (which will dictate parameter(s)) and the data (which will dictate how you choose independent vs dependent variables).</p></li>
<li><p>Does the model do what I want it to do? Before moving on to the next section of this chapter or thinking about fitting your model to data, make sure the function you wrote does what you want it to do! You can check that it runs, gives the output in the format you expect, and even create some figures to see how the curve changes as you plug in different parameter values.</p></li>
</ol>
<div class="rmdquestion">
<h4 id="question-2">
Question 2
</h4>
<p>
Create a model in MATLAB that you will use for the <em>dicty</em> growth data.
</p>
<p>
Note: You will want to create a single MATLAB function to use on both data sets. The model parameters are what should change the shape of your curve. In the last section, we will learn how to fit the correct parameter values in order to obtain one set of parameter values for the AX4 cells and another set for the DnmA KO cells.
</p>
<p>
After creating your model function, answer each of the 4 questions above.
</p>
</div>
</div>
<div id="creating-an-objective-error-function" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Creating an Objective / Error Function<a href="model-fitting-a.k.a.-parameter-estimation.html#creating-an-objective-error-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For Model Fitting, we need an Objective Function (which we will minimize). The most popular Objective Function is the Error Function calculated by taking the Sum of Square Errors (SSE):
<span class="math display">\[SSE = \sum_{i=1}^n \left(y_i - m_i\right)^2\]</span>
Luckily, MATLAB has a function that sums square terms of a vector for us, <code>sumsqr()</code>.</p>
<p>Examples:</p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p><img src="sumsqr1.png" />
Note: <span class="math inline">\(1^2+2^2+3^2+4^2 = 30\)</span></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p><img src="sumsqr2.png" />
Note: <span class="math inline">\(\left(1-1.4\right)^2+\left(2-1.7\right)^2+\left(3-2.9\right)^2+\left(4-4.2\right)^2 = 0.3\)</span></p>
<p>To create an Objective Function, the function needs to take the model parameter(s) and experimental data as input. The output should always be a <em>single number</em>, the SSE.</p>
<p>Example:</p>
<p>Lets assume we have some experimental data of the position of a frog as it jumps. We upload the data in to MATLAB and use a scatter plot to visualize.
<img src="frog_jump.png" />
Just looking at the data’s shape, we suggest using a quadratic model to fit this data. (This also fits what we have learned about projectile motion in Intro Physics.)</p>
<p>Next, we write the model function:
<img src="funpar.png" />
Now we need to write our Objective Function to calculate the error between the model and experimental data. The Objective Function should take as input: our parameter(s) as a <em>single vector</em> and our experimental data. It should output a <em>single value</em>, the SSE.
<img src="quad_error.png" />
Before moving on, we should run the Objective Function (with any parameter values we choose for now) just to make sure it runs and outputs a single number with no errors.
<img src="try_SSE.png" /></p>
<div class="rmdquestion">
<h4 id="question-3">
Question 3
</h4>
<p>
Create an objective function in the following way:
</p>
<ul>
<li>
The input should be the model parameter(s) as a single vector and the experimental data (as two vectors, values for the dependent variable and independent variable).
</li>
<li>
The function should run the model you created in Question 2 with the parameter(s) given and vector of dependent variable values.
</li>
<li>
The function should then calculate the SSE between the model output and the experimental data.
</li>
<li>
The output should be the SSE value.
</li>
</ul>
</div>
</div>
<div id="fitting-your-model-to-your-data" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Fitting your Model to your Data<a href="model-fitting-a.k.a.-parameter-estimation.html#fitting-your-model-to-your-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have experimental data, a mathematical model, and an objective funciton: now what?</p>
<p>Now we need to find the parameter values that minimize that objective function.</p>
<p>There are many ways to do this. In this section we will learn how to implement a local method of parameter estimation in MATLAB. Local methods take an initial guess for the parameter values and search nearby using techniques from Calculus or Geometry. In MATLAB, the most common function to use is <code>fminsearch()</code>. This function uses the Nelder-Mead simplex algorithm, but you don’t have to worry about that for this course. Just focus on how to run it.</p>
<div id="running-fminsearch" class="section level3 hasAnchor" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Running fminsearch()<a href="model-fitting-a.k.a.-parameter-estimation.html#running-fminsearch" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>fminsearch()</code> function has many different options available when running it. Since our Objective function takes multiple inputs and we only want to fit the parameter value(s), will run it using the following commands / syntax:</p>
<p><code>[x,fval] = fminsearch(@(p)function_name(p,t,y...),p_0);</code></p>
<p>Notes:</p>
<ul>
<li><p><code>p_0</code> is your initial guess for the parameter value(s). This needs to be a vector and parameters need to be given in the SAME order as they are input into your function (i.e. the same as <code>p</code>)</p></li>
<li><p><code>x</code> is a vector of parameter values that best fit your data</p></li>
<li><p><code>fval</code> is the SSE between your data and the model when <code>x</code> is used for the parameters in your model</p></li>
</ul>
<p>Example:
<img src="run_fminsearch.png" /></p>
<div class="rmdquestion">
<h4 id="question-4">
Question 4
</h4>
<p>
Run <code>fminsearch()</code> using the <em>dicty</em> growth data from Question 1 and your Objective Function from Question 3 to find the parameter values.
</p>
<p>
Note:
</p>
<ul>
<li>
You will have to do this TWICE since we have two data sets, the AX4 cells and the DnmA KO cells.
</li>
<li>
The growth data is different for these two data sets, so you should get two DIFFERENT sets of parameters.
</li>
<li>
Although this can all be done in the Command Window, you will want to use an mfile so you can edit, add comments, and save your commands.
</li>
</ul>
</div>
</div>
<div id="visualizing-the-best-fit" class="section level3 hasAnchor" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> Visualizing the Best Fit<a href="model-fitting-a.k.a.-parameter-estimation.html#visualizing-the-best-fit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once you have the optimal parameter values, you will want to see how good your fit looks with your data. You will do this in 3 steps:</p>
<ol style="list-style-type: decimal">
<li><code>scatter()</code> the experimental data (independent vs. dependent variables). Don’t forget to <code>hold on</code> to the figure.</li>
<li>Run the model with the parameter values that gave you the best fit. You can either use the vector of independent variable values from your experimental data or create your own vector (just make sure it includes a range of independent variable values that include those given in your data set).</li>
<li><code>plot()</code> the model results and label your figure.</li>
</ol>
<p>Example:
<img src="visualize_fit.png" />
<img src="modelFit.png" /></p>
<div class="rmdquestion">
<h4 id="question-5">
Question 5
</h4>
<p>
Create a visualization for your model fits to the <em>dicty</em> growth data.
</p>
<p>
You can do this either:
</p>
<ol style="list-style-type: decimal">
<li>
using two figures, one for the AX4 cells and one for the DnmA KO cells.
</li>
</ol>
<p>
OR
</p>
<ol start="2" style="list-style-type: decimal">
<li>
using a single figure with both sets of experimental data and both model fits.
</li>
</ol>
<p>
Make sure to include axes labels and a Legend!
</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="m-files-functions-and-simple-plotting-tools.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/11-ModelFitting.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
